name: $(BuildID).$(Date:yyyyMMdd).$(SourceBranchName)

parameters:
  - name: deployFromFeature
    displayName: "Deploy from Feature Branch"
    type: boolean
    default: false
  - name: deployToSecondaryRegion
    displayName: "Deploy to Secondary Region for DR"
    type: boolean
    default: false
  - name: skipPRE1
    displayName: "Skip PRE1 Deployment"
    type: boolean
    default: false

trigger:
  branches:
    include:
      - 'main'
      - 'develop'
      - 'hotfix/*'
      - 'feature/*'
      - 'epic/*'

resources:
  repositories:
    - repository: MMOPipelineCommon
      name: "DEFRA/eutd-mmo-fes-pipeline-common"
      endpoint: DEFRA
      type: github
      ref: refs/heads/main

extends:
  template: /includes/app-deployment.yaml@MMOPipelineCommon
  parameters:
    appName: 'mmo-fes-reference-data-reader'
    deployFromFeature: ${{ parameters.deployFromFeature }}
    deployToSecondaryRegion: ${{ parameters.deployToSecondaryRegion }}
    skipPRE1: ${{ parameters.skipPRE1 }}
